{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexj\\\\Programing Projects\\\\health_diary\\\\health_diary_frontend\\\\src\\\\pages\\\\user\\\\OAuth2RedirectHandler.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../../context/AuthContext\";\nimport { authApi } from \"../../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OAuth2RedirectHandler = () => {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    setToken,\n    setUser\n  } = useAuth();\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    // Parse the URL query parameters\n    const params = new URLSearchParams(location.search);\n    const token = params.get(\"token\");\n    const error = params.get(\"error\");\n    if (token) {\n      localStorage.setItem(\"token\", token);\n      setToken(token);\n      authApi.getCurrentUser().then(response => {\n        setUser(response.data);\n        setLoading(false);\n        navigate(\"/app/dashboard\");\n      }).catch(err => {\n        console.error(\"Failed to fetch user after OAuth login\", err);\n        localStorage.removeItem(\"token\");\n        setToken(null);\n        setUser(null);\n        setLoading(false);\n        navigate(\"/login\");\n      });\n    } else if (error) {\n      console.error(\"OAuth error:\", error);\n      setLoading(false);\n      navigate(\"/login\", {\n        state: {\n          error\n        }\n      });\n    } else {\n      // No token or error, redirect to login just in case\n      setLoading(false);\n      navigate(\"/login\");\n    }\n  }, [location, navigate, setToken, setUser]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        fontSize: \"1.5rem\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\",\n        style: {\n          border: \"4px solid #f3f3f3\",\n          borderTop: \"4px solid #3498db\",\n          borderRadius: \"50%\",\n          width: \"40px\",\n          height: \"40px\",\n          animation: \"spin 1s linear infinite\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          marginLeft: \"10px\"\n        },\n        children: \"Redirecting...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n        children: `\n          @keyframes spin {\n            0% { transform: rotate(0deg);}\n            100% { transform: rotate(360deg);}\n          }\n        `\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this);\n  }\n  return null;\n};\n_s(OAuth2RedirectHandler, \"VxZcQpaMSUyzmPxoKVxJaBAoSeU=\", false, function () {\n  return [useLocation, useNavigate, useAuth];\n});\n_c = OAuth2RedirectHandler;\nexport default OAuth2RedirectHandler;\nvar _c;\n$RefreshReg$(_c, \"OAuth2RedirectHandler\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","useAuth","authApi","jsxDEV","_jsxDEV","OAuth2RedirectHandler","_s","location","navigate","setToken","setUser","loading","setLoading","params","URLSearchParams","search","token","get","error","localStorage","setItem","getCurrentUser","then","response","data","catch","err","console","removeItem","state","style","height","display","justifyContent","alignItems","fontSize","children","className","border","borderTop","borderRadius","width","animation","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","_c","$RefreshReg$"],"sources":["C:/Users/alexj/Programing Projects/health_diary/health_diary_frontend/src/pages/user/OAuth2RedirectHandler.js"],"sourcesContent":["import React, { useEffect, useState} from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../../context/AuthContext\";\r\nimport { authApi } from \"../../services/api\";\r\n\r\nconst OAuth2RedirectHandler = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { setToken, setUser } = useAuth();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Parse the URL query parameters\r\n    const params = new URLSearchParams(location.search);\r\n    const token = params.get(\"token\");\r\n    const error = params.get(\"error\");\r\n\r\n    if (token) {\r\n      localStorage.setItem(\"token\", token);\r\n      setToken(token);\r\n\r\n      authApi\r\n        .getCurrentUser()\r\n        .then(response => {\r\n          setUser(response.data);\r\n          setLoading(false);\r\n          navigate(\"/app/dashboard\");\r\n        })\r\n        .catch(err => {\r\n          console.error(\"Failed to fetch user after OAuth login\", err);\r\n          localStorage.removeItem(\"token\");\r\n          setToken(null);\r\n          setUser(null);\r\n          setLoading(false);\r\n          navigate(\"/login\");\r\n        });\r\n    } else if (error) {\r\n      console.error(\"OAuth error:\", error);\r\n      setLoading(false);\r\n      navigate(\"/login\", { state: { error } });\r\n    } else {\r\n      // No token or error, redirect to login just in case\r\n      setLoading(false);\r\n      navigate(\"/login\");\r\n    }\r\n    }, [location, navigate, setToken, setUser]);\r\n\r\n    if (loading) {\r\n    return (\r\n      <div\r\n        style={{\r\n          height: \"100vh\",\r\n          display: \"flex\",\r\n          justifyContent: \"center\",\r\n          alignItems: \"center\",\r\n          fontSize: \"1.5rem\",\r\n        }}\r\n      >\r\n        {/* Simple spinner */}\r\n        <div className=\"spinner\" style={{\r\n          border: \"4px solid #f3f3f3\",\r\n          borderTop: \"4px solid #3498db\",\r\n          borderRadius: \"50%\",\r\n          width: \"40px\",\r\n          height: \"40px\",\r\n          animation: \"spin 1s linear infinite\"\r\n        }} />\r\n        <span style={{ marginLeft: \"10px\" }}>Redirecting...</span>\r\n\r\n        <style>{`\r\n          @keyframes spin {\r\n            0% { transform: rotate(0deg);}\r\n            100% { transform: rotate(360deg);}\r\n          }\r\n        `}</style>\r\n      </div>\r\n    );\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\nexport default OAuth2RedirectHandler;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}